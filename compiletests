#!/bin/bash

TESTDIR=tests
SUCCEEDING=$TESTDIR/succeeding
FAILING=$TESTDIR/failing
OUT_DIR=$TESTDIR/tests_out
EXPECT_DIR=$TESTDIR/tests_expect

mkdir -p $OUT_DIR
mkdir -p $EXPECT_DIR
mkdir -p $SUCCEEDING
mkdir -p $FAILING

SUCCEEDING_TESTS=$SUCCEEDING/*
FAILING_TESTS=($FAILING/*)

for n in $SUCCEEDING_TESTS; do
	arc $n
	if [ -e a.out ]; then
		./a.out
		OUTPUT=$?
		EXPECT=cat $EXPECT_DIR/$n.expect
		if [$OUTPUT == $EXPECT]; then
			echo "Success!"
		else
			echo $n "failed"
		fi
	else
		echo "Not assembling $n"
	fi
done


